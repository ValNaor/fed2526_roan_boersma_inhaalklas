define(["z-shop-event-bus","classnames","rendering-engine-api","react"],(e,t,r,n)=>(self.renderingEngineWebpackJsonp=self.renderingEngineWebpackJsonp||[]).push([[49049],{2711:e=>{e.exports={id:"5e09ff73031ec5fb1f86b8e7e40557096fa6a3b673443e530e156baea903c95e"}},21775:t=>{"use strict";t.exports=e},30812:e=>{"use strict";e.exports=t},32740:e=>{"use strict";e.exports=r},34538:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>w});var n=r(85959),i=r(29443),o=r(32740),a=r(11506),l=r(3090),s=r(91577),d=r(30812),c=r.n(d),u=r(21775),m=r.n(u),_=r(90425),g=r(4821),y=r(56096),p=r(52130),v=r(2673),E=r(25277),f=r(10170),h=r(5073),S=r(22837),N=r(15184),k=r(41825),D=r(51599),P=r(75839);const O="PRIORITY_ACCESS_INVITE_NUDGE",T="OUT_OF_STOCK_BENEFIT_NUDGE",C="CROSS_PROPOSITION_MISSION_NUDGE",I="DELIVERY_BENEFIT_SIGN_UP_NUDGE",b="MEASURE_BODY_MISSION_NUDGE",x=({loyaltyNudge:e,loyaltyPointsProgram:t,isDesignerExperience:r,locale:i,isInverted:a,sku:s,tracking:d,isLagomStage1BorderRadiusEnabled:m})=>{var x,R,w;const L=n.useContext(N.ix),B=n.useRef(null),A=((e,t,r)=>{var n;const i=null==(n=e.cta)?void 0:n.uri;if(!i)return{href:void 0,onClick:void 0};const o=i.startsWith("/plus/consent"),a=e.kind===b;return o?{href:void 0,onClick:()=>{const e=(0,y.S)(i);u.trigger(l.Hi.OPEN,{context:e})}}:a?{href:void 0,onClick:()=>{var n;const i=e;u.trigger(l.rt.OPEN,{entryPoint:l.rt.ENTRY_POINT,source:l.rt.PDP_SOURCE,sku:r,loyaltyPoints:null==(n=i.points)?void 0:n.amount,callbacks:{close:()=>{var e;null==(e=t.current)||e.focus()}}})}}:{href:i,onClick:void 0}})(e,B,s),F=(({kind:e,hasCTA:t})=>{let r="";return e===I&&(r="loyalty_opt_in_placement"),e===T&&(r="priority_size_reminder|||config_level|||"+(t?"with_loyalty_opt_in":"without_loyalty_opt_in")),e===O&&(r="priority_access|||"+(t?"with_loyalty_opt_in":"without_loyalty_opt_in")),e===C&&(r="cross_proposition|||"+(t?"with_loyalty_opt_in":"without_loyalty_opt_in")),e===b&&(r="get_measured|||collect_plus_points_for_providing_body_measurement"),{name:"view_content",context:{event_trigger_name:r}}})({kind:e.kind,hasCTA:Boolean(e.cta)}),U=(({loyaltyNudge:e,isInverted:t,isDesignerExperience:r,isLagomStage1BorderRadiusEnabled:i})=>n.useMemo(()=>{let n=S.z.default,o="",a="",l=c()(k.$A,k.Nd,k.e6,k.FQ,k.NB,D.sS9),s=D.GUV,d=p.nx.bodySmallBold;return t&&(n=S.z.monochromeDark),r&&(n=S.z.monochromeLight),i&&(a=c()(k.xG)),t&&!r&&(a=c()(P.nME,P.vAn,P.$4c,f.Gmw,f.zFk),l=""),(null==e?void 0:e.kind)!==C&&(null==e?void 0:e.kind)!==b||(n=S.z.default,l="",s=D.JSK,d=p.nx.bodyLargeBold),(null==e?void 0:e.kind)!==I&&(null==e?void 0:e.kind)!==T||(o=c()(k.FQ,k.NB,D.sS9),a="",l=""),{wrapperClassName:o,colorScheme:n,className:c()(a,l,s),textPreset:{title:d}}},[null==e?void 0:e.kind,t,r,i]))({loyaltyNudge:e,isInverted:a,isDesignerExperience:r,isLagomStage1BorderRadiusEnabled:m});return n.createElement("div",{className:U.wrapperClassName},n.createElement(o.ViewTracker,{enableStandaloneOnly:!0,standaloneEvents:F?[F]:void 0},n.createElement(N.Sv,{colorScheme:U.colorScheme},n.createElement("div",{"data-testid":"product-loyalty-points-nudge",className:U.className},n.createElement("div",{className:c()(f.cgu)},(null==e||null==(x=e.header)?void 0:x.asset)?n.createElement(N.Sv,{colorScheme:L===S.z.inherit?S.z.default:L},n.createElement(g.A,{logo:null==e||null==(R=e.header)?void 0:R.asset,size:"s",logoLabel:null==t||null==(w=t.tier)?void 0:w.name,icon:null==t?void 0:t.icon})):null,e.title?n.createElement(v.Ay,{tag:"p",preset:U.textPreset.title,className:f.aUF},e.title):null,n.createElement(v.Ay,{tag:"p",preset:p.nx.bodySmall,className:f.E0r},e.description),((e,t)=>{if(!e)return null;const{date:r,time:i,dateTimeDivider:o}=(0,_.r)(e,t);return n.createElement(v.Ay,{tag:"p",preset:p.nx.bodySmallBold},r,o,i)})(e.date,i),e.cta?n.createElement("div",{className:c()(f.aUF,h.OL)},n.createElement(E.Q,{forwardedRef:B,size:"medium",label:e.cta.label,href:A.href,"aria-haspopup":A.onClick?"dialog":void 0,onClick:()=>{((e,t)=>{let r="";t===I&&(r="loyalty_opt_in_placement"),t===T&&(r="priority_size_reminder|||config_level|||with_loyalty_opt_in"),t===O&&(r="priority_access|||with_loyalty_opt_in"),t===C&&(r="cross_proposition|||with_loyalty_opt_in"),t===b&&(r="get_measured|||collect_plus_points_for_providing_body_measurement"),e.trackStandalone({name:"select_content",context:{event_trigger_name:r}})})(d,e.kind),null==A.onClick||A.onClick.call(A)}})):null)))))};var R=r(2711);const w=(0,o.tile)({shouldRefreshData:!1}).withQueries((e,t)=>({data:{query:R,variables:{id:e.entity.id},...t.shouldRefreshData&&{fetchPolicy:"network-only"}}})).withTracking(e=>({def:i.def,context:{id:e.entity.id}})).withProcessDependencies(({data:e},{entity:t,ruleData:r})=>{var n,i,o,a;if(!e)return{action:"error",message:"Invalid data"};const{product:l,loyaltyPointsProgram:d}=e;if(!l)return{action:"error",message:"Invalid product"};if(null==e?void 0:e.errors)return{action:"error",message:(0,s.V)(e.errors),error:!0};const[,c,u]=t.hints,m=(null==l||null==(o=l.simples)||null==(i=o.find(e=>e.sku===u))||null==(n=i.offer.loyaltyPointsProgram)?void 0:n.nudge)||(null==l||null==(a=l.loyaltyPointsProgram)?void 0:a.nudge);var _;if(c&&!c.includes(null!=(_=null==m?void 0:m.kind)?_:""))return{action:"error",message:"Invalid useCase"};if(!m)return{action:"error",message:"No loyalty nudge data"};return{action:"render",data:{loyaltyNudge:m,loyaltyPointsProgram:d,sku:null==l?void 0:l.sku,isLagomStage1BorderRadiusEnabled:!!r.isLagomStage1BorderRadiusEnabled},rendererState:{shouldRefreshData:!1}}}).withRender(({data:{loyaltyPointsProgram:e,loyaltyNudge:t,sku:r,isLagomStage1BorderRadiusEnabled:i},context:{locale:o,experience:s},tools:d})=>{const{experienceName:c}=(0,a.q)(s),u=n.useCallback(()=>{d.setRendererState({shouldRefreshData:!0})},[d.setRendererState]);return n.useEffect(()=>(m().on(l.rt.COMPLETE,u),()=>{m().off(l.rt.COMPLETE,u)}),[u]),n.createElement(x,{loyaltyNudge:t,loyaltyPointsProgram:e,tracking:d.tracking,locale:o,isDesignerExperience:null==c?void 0:c.isDesigner(),isInverted:!0,sku:r,isLagomStage1BorderRadiusEnabled:i})})},56096:(e,t,r)=>{"use strict";r.d(t,{G:()=>o,S:()=>a});var n=r(45728);function i(e){if(Array.isArray(e)){if(e.length>1)return n.o.INVALID_CONTEXT;e=e[0]}if(!e)return n.o.MISSING_CONTEXT;const t=n.o[String(e).toUpperCase()];return t||n.o.INVALID_CONTEXT}function o({query:e={}}){return i(e.context)}const a=e=>{var t;const r=null==(t=e.split("?"))?void 0:t[1];return i(new URLSearchParams(r).getAll("context"))}},85959:e=>{"use strict";e.exports=n},90425:(e,t,r)=>{"use strict";r.d(t,{r:()=>d});const n={hour:"numeric",minute:"numeric",hour12:!1},i={dateFormatOptions:{day:"numeric",month:"long",year:"numeric"},dateTimeDivider:" @ ",timeFormatOptions:n},o={...i,dateTimeDivider:" um "},a={...i,dateTimeDivider:" alle "},l={...i,dateTimeDivider:" Ã  "},s={"de-DE":o,"en-GB":{...i,timeFormatOptions:{...n,hour12:!0}},"fr-FR":l,"nl-NL":{...i},"it-IT":a,"de-CH":o,"fr-CH":l,"it-CH":a,"de-AT":o,"fr-BE":l,"fr-LU":l},d=(e,t,r)=>{const n=(e=>{var t;return null!=(t=s[e])?t:i})(t);var o;const a=null!=(o=null==r?void 0:r.dateFormatOptions)?o:n.dateFormatOptions;var l;const d=null!=(l=null==r?void 0:r.timeFormatOptions)?l:n.timeFormatOptions;var c;const u=null!=(c=null==r?void 0:r.dateTimeDivider)?c:null==n?void 0:n.dateTimeDivider,m=new Date(e);return{date:m.toLocaleString(t,a),time:m.toLocaleString(t,d),dateTimeDivider:u}}}},e=>(e.O(0,[29674],()=>{return t=34538,e(e.s=t);var t}),e.O())]));
//# sourceMappingURL=https://zalando.de/dev/source-maps/product_loyalty-nudge/index-67fdbedce25301755aae.js.map