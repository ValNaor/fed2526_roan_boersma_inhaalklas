define(["@dx/experiments","z-shop-event-bus","classnames","rendering-engine-api","react-dom","react"],(e,t,n,r,a,l)=>(self.renderingEngineWebpackJsonp=self.renderingEngineWebpackJsonp||[]).push([[14773],{188:e=>{e.exports={id:"7bc175d95a37b2cd33f0a75e583e70060182aaba2954efe6fb7dbc584fa8a04d"}},10144:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});var r=n(85959);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},l=Object.keys(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}const o=function(e){var t=e.title,n=e.titleId,o=l(e,["title","titleId"]);return r.createElement("svg",function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){a(e,t,n[t])})}return e}({viewBox:"0 0 24 24",width:"1em",height:"1em",fill:"currentColor","aria-labelledby":n},o),t?r.createElement("title",{id:n},t):null,r.createElement("path",{d:"M21.75 7.512H16.5v-5.25a2.25 2.25 0 0 0-2.25-2.25h-12A2.25 2.25 0 0 0 0 2.262v12a2.25 2.25 0 0 0 2.25 2.25H7.5v5.25a2.25 2.25 0 0 0 2.25 2.25h12a2.25 2.25 0 0 0 2.25-2.25v-12a2.25 2.25 0 0 0-2.25-2.25m-19.5 7.5a.75.75 0 0 1-.75-.75v-12a.75.75 0 0 1 .75-.75h12a.75.75 0 0 1 .75.75v5.25H9.75a2.25 2.25 0 0 0-2.25 2.25v5.25zm20.25 6.75a.75.75 0 0 1-.75.75h-12a.75.75 0 0 1-.75-.75v-12a.75.75 0 0 1 .75-.75h12a.75.75 0 0 1 .75.75z"}))}},14455:e=>{e.exports={id:"bb0bbca8d9d11dc84ddd7c86d2978a2a30b9adec2754104eee829d79e45ef6ab"}},15895:t=>{"use strict";t.exports=e},21775:e=>{"use strict";e.exports=t},30812:e=>{"use strict";e.exports=n},32740:e=>{"use strict";e.exports=r},48398:e=>{"use strict";e.exports=a},85959:e=>{"use strict";e.exports=l},96465:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>Ie});var r=n(85959),a=n(29443),l=n(32740),o=n(52292),i=n(97195),c=n(30812),s=n.n(c),u=n(14410),d=n(10170),m=n(41825),p=n(36124),f=n(2673),v=n(52130),g=n(97822),b=n(65476),y=n(5073),E=n(38856),h=n(24832),O=n(14936),_=n(95141),C=n(21775);const S="PDP$CHANGE_SIZE",x="PDP$UNSELECT_SIZE",L="PDP$OFFER_ADDED_TO_CART",N="default",k="incentives",w="product detail page",T=/#([^#\s]+)#/g,I=/(#[^#\s]+#)/g,A=__("incentives.legal_terms.info_icon.aria_label"),P=__("incentives.legal_terms.dialog.loading_error");var B=function(e){return e.LearnMore="LEARN_MORE",e.SignUp="PLUS_SIGNUP",e}({}),D=n(89862);const M=r.createContext(null),U={currentSKU:void 0,currentOffer:void 0,isBannerDisplayedOnce:!1,setCurrentSKU:()=>{},setCurrentOffer:()=>{},setIsBannerDisplayedOnce:()=>{}},j=r.createContext(U),K=({children:e,defaultValue:t})=>{const[n,a]=r.useState((null==t?void 0:t.currentSKU)||void 0),[l,o]=r.useState((null==t?void 0:t.currentOffer)||void 0),[i,c]=r.useState((null==t?void 0:t.isBannerDisplayedOnce)||!1),s={currentSKU:n,currentOffer:l,isBannerDisplayedOnce:i,setCurrentSKU:a,setCurrentOffer:o,setIsBannerDisplayedOnce:c};return r.createElement(j.Provider,{value:s},e)},$=j,H=(e,t=!1)=>({text:e,isBold:t}),R=(e,t)=>{if(!e)return[];const n=e.match(T);if(!n)return[H(e)];const r=new Map(null==t?void 0:t.map(e=>[`#${e.key}#`,e.value]));return n.some(e=>!r.has(e))?[]:((e,t)=>e.split(I).filter(e=>e).map(e=>t.has(e)?H(t.get(e)||e,!0):H(e)))(e,r)},F={isLoading:!1,header:void 0,content:void 0,error:!1,setIsLoading:()=>{},setHeader:()=>{},setContent:()=>{},setError:()=>{}},Q=r.createContext(F),z=({children:e,defaultValue:t})=>{const[n,a]=r.useState((null==t?void 0:t.isLoading)||!1),[l,o]=r.useState(null==t?void 0:t.header),[i,c]=r.useState(null==t?void 0:t.content),[s,u]=r.useState((null==t?void 0:t.error)||!1),d={isLoading:n,header:l,content:i,error:s,setIsLoading:a,setHeader:o,setContent:c,setError:u};return r.createElement(Q.Provider,{value:d},e)},W=Q;var G=n(188);const Z=({campaignId:e,executeQuery:t,trackEvent:n,store:r})=>(r.setIsLoading(!0),function(e,t){return()=>{const n={name:D.zM,context:{entity_id:t,customLabel:k}};e(n)}}(n,e)(),t({...G,variables:{id:e}}).then(({data:e})=>{var t,n;(null==e?void 0:e.incentivesLegalTerms)?(r.setHeader(Y(null==(t=e.incentivesLegalTerms)?void 0:t.title)),r.setContent(Y(null==(n=e.incentivesLegalTerms)?void 0:n.description))):r.setError(!0);r.setIsLoading(!1)})),Y=e=>e?e.replace(new RegExp("\\n","g"),"<br/>"):"";var q=n(51599),V=n(10144),X=n(3906),J=n(58777),ee=n(91936),te=n(28258),ne=n(36093),re=n(41650),ae=n.n(re),le=n(4050),oe=n(32099),ie=n(15384);const ce={root:s()(y.OL,E.FnB),prefix:s()(le.N,d.sWS),contentWrapper:s()(y.OL,E.rXj,E.EJS,oe.Gm),content:s()(le.N,d.bDL),suffix:s()(le.N)},se={root:s()(q.hLC,m.Hq,d.iZo,ie.clickToHide),spanWrapper:s()(d.ZEI)},ue=ce,de=e=>{const{labels:t,content:n,onCopy:a}=e;return r.createElement("div",{className:s()(ue.root)},r.createElement("dl",{className:ue.contentWrapper},Boolean(t.contentLabel)&&r.createElement(f.Ay,{className:s()(ue.prefix),preset:v.nx.bodySmall,tag:"dt"},t.contentLabel),r.createElement(f.Ay,{preset:v.nx.bodyLargeBold,className:s()(ue.content,ne.xB),tag:"dd"},n)),r.createElement(X.A,{className:ue.suffix,"aria-label":t.copyButtonLabel,styles:se,onClick:async()=>{if("string"==typeof n){if(await ae()(n),t.notificationMessage){const e=r.createElement(ee.E,{timeout:3e3,ariaLive:t.notificationMessage},r.createElement(f.Ay,{color:v.r7.inverse,preset:v.nx.body},t.notificationMessage));te.h.show(e)}"function"==typeof a&&a()}},preset:J.lH.default},r.createElement(p.A,{src:V.A})))},me=({richTextNodes:e})=>r.createElement(r.Fragment,null,(e||[]).map((e,t)=>r.createElement(f.Ay,{key:`node-part-${t}`,preset:e.isBold?v.nx.bodySmallBold:v.nx.bodySmall,color:v.r7.primary},e.text)));var pe=n(6249),fe=n(96545);const ve=({href:e,label:t,onClick:n})=>t&&(e||n)?r.createElement("div",{className:s()(d.QgQ)},e?r.createElement(pe.A,{size:fe.s.medium,href:e,onClick:n},t):r.createElement(pe.Y,{size:fe.s.medium,onClick:n},t)):null,ge=(0,l.createLoadableComponent)(()=>n.e(36304).then(n.bind(n,36304)).then(e=>e.default)),be=({richTextNodes:e,intent:t,legalTerms:n,couponCode:a,onCouponCopyClick:l,onCtaClick:o})=>r.createElement(r.Fragment,null,r.createElement("div",{className:s()(y.OL)},r.createElement("div",null,r.createElement(me,{richTextNodes:e})),!!n&&r.createElement(ge,n)),!!a&&r.createElement("div",{className:s()(d.XiK)},r.createElement(de,{labels:{contentLabel:__("incentives.copy_coupon.label"),notificationMessage:__("voucher.copy.clipboard.success.notification"),copyButtonLabel:__("a11y.slim_sales_banner.copy_voucher")},content:a,onCopy:l})),t&&r.createElement(ve,{href:t.uri||"#",label:t.label,onClick:o}));var ye=n(4821);const Ee=(0,l.createLoadableComponent)(()=>n.e(36304).then(n.bind(n,36304)).then(e=>e.default)),he=({richTextNodes:e,intent:t,legalTerms:n,onCtaClick:a,couponCode:l,onCouponCopyClick:o})=>r.createElement(r.Fragment,null,r.createElement("div",{className:s()(d.yON,y.OL)},r.createElement("div",{className:s()(y.OL,oe.Gm,E.FnB)},r.createElement(ye.A,{size:"s",logo:"LoyaltyPoints"})),!!n&&r.createElement(Ee,n)),r.createElement(me,{richTextNodes:e}),!!l&&r.createElement("div",{className:s()(d.XiK)},r.createElement(de,{labels:{contentLabel:__("incentives.copy_coupon.label"),notificationMessage:__("voucher.copy.clipboard.success.notification"),copyButtonLabel:__("a11y.slim_sales_banner.copy_voucher")},content:l,onCopy:o})),t&&r.createElement(ve,(e=>B.LearnMore===e.kind?{href:e.uri||void 0,onClick:a,label:e.label}:{href:"#",onClick:()=>{},label:e.label})(t))),Oe=e=>{const{isLoyaltyUseCase:t}=e;let n=r.createElement(be,e);return t&&(n=r.createElement(he,e)),r.createElement("div",{className:s()(d.Ol8,d.cgu,m.$A,m.Nd,m.e6,m.FQ,m.NB,q.sS9)},n)},_e=e=>({isLoyaltyUseCase:"LOYALTY_POINTS"===e.useCase,richTextNodes:R(e.messageTemplate,e.properties),intent:e.intent||void 0,couponCode:e.couponCode||void 0}),Ce=(e,t)=>{const{tracking:n}=e;return{onCtaClick:()=>((e,t)=>e.track({name:D.bD,context:{customCategory:w,customLabel:`${k}:${t}`}}))(n,t),onCouponCopyClick:()=>((e,t)=>e.track({name:D.bD,context:{customCategory:"product detail page",customLabel:`incentives.coupon_code:${t}`}}))(n,t)}},Se=(e,t,n,a)=>{const l={root:s()(m.Hq,d.iZo),spanWrapper:s()(d.ZEI),spanWrapperWithImage:s()(d.joi,d.$sS,d.sf0)};var o;const i={labels:{legalTerms:null!=(o=t.content)?o:"",legalTermsIconAriaLabel:A},styles:l,isHTMLContent:!0,isLoadingData:t.isLoading,onOpenDialog:()=>{if(e.legalTerms&&!t.content)return Z({campaignId:e.legalTerms.id,executeQuery:n,trackEvent:a,store:t})},header:t.header?r.createElement(r.Fragment,null,r.createElement("div",{className:d.uvl},r.createElement(p.A,{src:g.A,fontSize:"custom",className:u.h2})),r.createElement(f.Ay,{preset:v.nx.h3,tag:"h3",className:d.uvl},t.header)):void 0,loadingBody:r.createElement("div",{className:s()(y.OL,E.bd9,E.vFE,h.Ig,E.t4,O.Xv)},r.createElement(p.A,{src:b.A,className:s()(E.bd9,_.m)})),legalTermsLoadErrorMessage:t.error?P:void 0};return{legalTerms:e.legalTerms?i:void 0}},xe=({configSku:e,executeQuery:t,trackEvent:n,prio2TrackingConfig:a})=>{const l=r.useContext(M),o=r.useContext($),i=r.useContext(W);if(l&&o&&o.currentSKU){var c,s;const u=null!=(s=o.currentOffer)?s:l.defaultOfferBySKU.get(o.currentSKU),d=u?null==(c=l.incentivesBySKU.get(o.currentSKU))?void 0:c.get(u):void 0;if(r.useEffect(()=>{var t;return t=e=>o.setCurrentSKU(e),C.on(S,e=>{t(e)}),(e=>{C.on(x,e)})(()=>o.setCurrentSKU(e)),(e=>{C.on(L,t=>{e(t)})})(e=>o.setCurrentOffer(e)),()=>{C.off(S),C.off(x),C.off(L)}},[]),r.useEffect(()=>{!o.isBannerDisplayedOnce&&d&&(((e,t,n)=>{var r;e.track({name:D.wc,context:{customCategory:w,customLabel:`${k}:${t}`}},n),e.trackStandalone({name:"view_content",context:{legacy_event_name:D.wc,event_trigger_name:`${r=`${k}_${t}`,r.replace(/[^a-zA-Z0-9]/g,"_").replace(/^_|_$/g,"").toLowerCase()}`}},n)})(l.tracking,d.id,a),o.setIsBannerDisplayedOnce(!0))}),!d)return null;const m={..._e(d),...Ce(l,d.id),...Se(d,i,t,n)};return m.richTextNodes.length?r.createElement(Oe,m):null}return null},Le=(e,t,n,r)=>{let a=n.get(e);a||(a=new Map,n.set(e,a)),r&&a.set(t,r)},Ne=(e,t)=>{const n=new Map;return t.incentives&&t.incentives.length&&Le(e,N,n,t.incentives[0]),t.simples&&t.simples.length&&t.simples.forEach(e=>{var t;null==(t=e.allOffers)||t.forEach(t=>{var r,a;t.incentives&&t.incentives.length&&(null==(r=t.merchant)?void 0:r.id)&&Le(e.sku,null==(a=t.merchant)?void 0:a.id,n,t.incentives[0])})}),n},ke=(e,t)=>{const n=new Map;return t.incentives&&t.incentives.length&&n.set(e,N),t.simples&&t.simples.length&&t.simples.forEach(e=>{var t;null==(t=e.allOffers)||t.forEach(t=>{var r,a;t.incentives&&t.incentives.length&&(null==(r=t.merchant)?void 0:r.id)&&t.isDefaultOffer&&n.set(e.sku,null==(a=t.merchant)?void 0:a.id)})}),n};var we=n(14455);const Te=(0,o.C)(e=>e.children),Ie=(0,l.tile)().withQueries(({entity:{id:e}})=>({data:{query:we,variables:{id:e}}})).withTracking(e=>({def:a.def,context:{id:e.entity.id}})).withProcessDependencies(e=>{const{product:t}=e.data;return t?{action:"render",data:{product:t}}:{action:"error",message:"Invalid product"}}).withRender(e=>{const{context:{deviceInfo:t,navigation:n},data:{product:a},tools:{setRendererState:l,tracking:o,executeQuery:c},entity:{id:s},ruleData:u}=e;if(!a)return null;const{isDesktop:d,isMobile:m}=t,p={isMobile:m,defaultOfferBySKU:ke(s,a),incentivesBySKU:Ne(s,a),tracking:o},f=(0,i.tQ)(a,n.url.query)||s,v={currentSKU:f,currentOffer:(0,i.mY)(a,f),isBannerDisplayedOnce:!1},g={header:void 0,content:void 0},b={enableStandaloneInShadow:!!u.enableStandaloneInShadowPrior2,enableStandaloneOnly:!!u.enableStandaloneOnlyPrior2};return r.createElement(Te,{disableListeners:!0,serverMedia:t,isTouchOnServer:!d},r.createElement(M.Provider,{value:p},r.createElement(K,{defaultValue:v},r.createElement(z,{defaultValue:g},r.createElement(xe,{setRendererState:l,configSku:s,executeQuery:c,trackEvent:e=>o.track(e),prio2TrackingConfig:b})))))})},97822:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});var r=n(85959);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},l=Object.keys(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}const o=function(e){var t=e.title,n=e.titleId,o=l(e,["title","titleId"]);return r.createElement("svg",function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){a(e,t,n[t])})}return e}({viewBox:"0 0 24 24",width:"1em",height:"1em",fill:"currentColor","aria-labelledby":n},o),t?r.createElement("title",{id:n},t):null,r.createElement("path",{d:"M23.043 12.235 11.703.895A2.98 2.98 0 0 0 9.58.015H3.018c-1.655 0-3 1.346-3 3.006l.014 6.59a2.98 2.98 0 0 0 .88 2.114l11.32 11.32a3 3 0 0 0 2.12.878 3 3 0 0 0 2.123-.877l6.568-6.568a3.005 3.005 0 0 0 0-4.243m-1.06 3.182-6.569 6.568a1.504 1.504 0 0 1-2.121 0L1.972 10.665a1.5 1.5 0 0 1-.44-1.058l-.014-6.592c0-.827.672-1.5 1.5-1.5H9.58c.4 0 .777.156 1.06.44l11.341 11.34a1.504 1.504 0 0 1 0 2.122"}),r.createElement("path",{d:"M14.713 9.004 9 14.716a.75.75 0 1 0 1.061 1.06l5.711-5.712a.75.75 0 1 0-1.06-1.06"}),r.createElement("circle",{cx:14.6,cy:14.6,r:1.1}),r.createElement("path",{d:"M10.137 11.265a1.125 1.125 0 1 0 0-2.25 1.125 1.125 0 0 0 0 2.25m-4.875-8.25c-1.24 0-2.25 1.01-2.25 2.25s1.01 2.25 2.25 2.25 2.25-1.01 2.25-2.25-1.01-2.25-2.25-2.25m0 3a.75.75 0 1 1 .002-1.502.75.75 0 0 1-.002 1.502"}))}},99251:()=>{window.__RENDERING_ENGINE_TRANSLATION_KEYS__={...window.__RENDERING_ENGINE_TRANSLATION_KEYS__,product_incentives:["incentives.legal_terms.info_icon.aria_label","incentives.legal_terms.dialog.loading_error","incentives.copy_coupon.label","voucher.copy.clipboard.success.notification","a11y.slim_sales_banner.copy_voucher"]}}},e=>{var t=t=>e(e.s=t);return e.O(0,[29674],()=>(t(99251),t(96465))),e.O()}]));
//# sourceMappingURL=https://zalando.de/dev/source-maps/product_incentives/index-82f11e2b76c344c0d782.js.map