define(["classnames","rendering-engine-api","react","zalando-consent-api"],(e,t,n,a)=>(self.renderingEngineWebpackJsonp=self.renderingEngineWebpackJsonp||[]).push([[31972],{30812:t=>{"use strict";t.exports=e},32740:e=>{"use strict";e.exports=t},63225:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>J});var a=n(32740),r=n(85959),o=n(94179);const l="smart_app_download_banner",s="smart_app_download_banner",c="app_download_banner_exited",i=[1,1,1,1,1],d=[1,1,1,1,.5];function u(e){const t=e.get(l),n={view_count:((null==t?void 0:t.view_count)||0)+1};e.set(l,n,21)}const m={de_AT:430,fr_BE:321,nl_BE:320,de_CH:410,fr_CH:411,cz_CZ:420,de_DE:490,dk_DK:450,es_ES:340,en_IE:353,fi_FI:358,fr_FR:330,it_IT:390,nl_NL:310,no_NO:470,pl_PL:480,pt_PT:351,se_SE:460,en_GB:440,lt_LT:370,sk_SK:421,sl_SI:386,lv_LV:371,et_EE:372,hr_HR:385,hu_HU:360,ro_RO:400,fr_LU:352,de_LU:354,bg_BG:359,el_GR:300},p=["pl-PL","nl-NL","tr-TR","de-CH","fr-CH","it-CH","da-DK","de-DE","en-DE","no-NO","fi-FI","ru-RU","nl-BE","fr-BE","fr-FR","es-ES","it-IT","en-GB","sv-SE","de-AT","en-IE","cs-CZ","lt-LT","sk-SK","sl-SI","lv-LV","et-EE","hr-HR","hu-HU","ro-RO","pt-PT","fr-LU","de-LU","bg-BG","el-GR"];function _(e){const{id:t,language:n,domain:a}=function(e){const[t="",n=""]=e.split("-"),a=m[`${t}_${n}`];return a?{id:a,language:t,domain:n}:{id:490,language:"de",domain:"DE"}}(e),r=`orf${t}__smartbanner.___.`;return`adjust_t=kcry49g_t9wexgj&adjust_campaign=${`${a.toLowerCase()}_${n}_smartbanner_1`}&adjust_adgroup=${r}`}async function f({locale:e,appStoreUrl:t}){let n=!1;try{n=(await(0,a.promiseWithTimeout)((0,o.getConsent)("smart_app_download_banner"),100)).status}catch(e){}if(!n)return t;const r=_(e),l=function(){if("undefined"!=typeof window&&"undefined"!=typeof document){const e=Array.from(document.getElementsByTagName("meta")).find(e=>"al:ios:url"===e.getAttribute("property"));if(null==e?void 0:e.content)return e.content}return"zalando://ROOT"}(),s=encodeURIComponent(l);return`https://Hfe2.adj.st/${l.replace("zalando://","")}${l.includes("?")?"&":"?"}${r}&adjust_deeplink=${s}`}var E=n(30812),g=n.n(E),w=n(51599),b=n(42768),v=n(5073),S=n(38856),y=n(87548),L=n(22940),h=n(3906),$=n(58777),k=n(36124),x=n(9049);const C=({onClose:e})=>r.createElement("div",{className:g()(v.OL,S.FnB,S.n$d)},r.createElement(h.A,{"aria-label":__("main.close"),label:__("main.close"),size:"small",preset:$.lH.transparent,onClick:e,type:"button",style:{padding:6,transform:"translateX(-6px)"}},r.createElement(k.A,{src:x.A,style:{width:"0.75rem",height:"0.75rem"}})));var R=n(50682);const N=({appRatingArray:e})=>{const t=e.reduce((e,t)=>e+t,0);return r.createElement("div",{"aria-label":`rating score ${t} out of 5`,role:"img"},e.map((e,t)=>{let n="StarOutlined";return.5===e?n="StarHalf":e&&(n="StarFilled"),r.createElement(R.A,{key:t,fontSize:"custom",icon:n,size:10,style:{fontSize:"0.625rem",paddingRight:2}})}))},I=()=>r.createElement("svg",{width:"36",height:"36",viewBox:"0 0 36 36",fill:"none",style:{borderRadius:"6px"},"aria-hidden":"true"},r.createElement("path",{fill:"#fff",d:"M0 0h36v36H0z"}),r.createElement("path",{fill:"#ff4c00",d:"M28.34 15.56c-1.59-2-3.82-3.91-6.72-5.65h-.02a24.08 24.08 0 0 0-8.15-3.11c-1.55-.26-2.3.04-2.63.23-.33.2-.96.7-1.52 2.2a25.6 25.6 0 0 0-1.44 8.76V18a25.5 25.5 0 0 0 1.44 8.77c.56 1.48 1.19 2 1.52 2.19.33.19 1.08.49 2.63.23a24 24 0 0 0 8.15-3.1h.02a24.75 24.75 0 0 0 6.72-5.66c1-1.24 1.1-2.05 1.1-2.45 0-.38-.1-1.2-1.1-2.43Z"}));var A=n(2673),B=n(52130),O=n(10170);const T=({appPlatform:e})=>{const t="ios"===e?"(902k)":"(1.01M)",n="ios"===e?i:d;return r.createElement("div",{className:g()(v.OL,S.FnB),style:{gap:8}},r.createElement("div",{className:g()(v.OL,S.FnB,O.XSc)},r.createElement(I,null)),r.createElement("div",{className:g()(v.OL,S.YVv,S.vFE,S.XU$,S.n$d)},r.createElement(A.Ay,{preset:B.nx.bodySmallBold},"Zalando"),r.createElement("div",{className:g()(v.OL,S.lE2)},r.createElement(N,{appRatingArray:n}),r.createElement(A.Ay,{style:{padding:2},preset:B.nx.bodyExtraSmall},t))))};var H=n(85202);const P=({onInstall:e})=>{const[t,n]=r.useState(8.25);return r.useEffect(()=>{const e=()=>{n(window.innerWidth>329?8.25:7.85)};return e(),window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}},[]),r.createElement("div",{className:g()(v.OL,S.Gsz,S.FnB),style:{flex:"1 0 auto"}},r.createElement(H.j,{role:"link","aria-label":`${__("download.app.banner.cta")} ${__("download.app.banner.alt.cta")}`,label:__("download.app.banner.cta"),onClick:e,style:{padding:8,minWidth:`${t}rem`}}))},F=()=>{const[e,t]=(0,r.useState)(60),n=(0,r.useRef)(null),a=(0,r.useCallback)(()=>{setTimeout(()=>{if(n.current){const e=n.current.offsetHeight;t(e)}},10)},[n]);return(0,r.useEffect)(()=>{const e=()=>{requestAnimationFrame(a)};return window.addEventListener("resize",e),e(),()=>{window.removeEventListener("resize",e)}},[a]),{bannerRef:n,bannerHeightInPixels:e}};var z=n(62030);const D=e=>{const[t,n]=(0,r.useState)((0,a.isBrowser)()),o=(0,r.useRef)(0),[l]=(0,z.A)(()=>{const a=window.scrollY;t&&a>o.current&&n(!1),!t&&a<o.current&&a>e&&n(!0),o.current=a},20);return(0,r.useEffect)(()=>((0,a.isBrowser)()&&window.addEventListener("scroll",l),()=>{(0,a.isBrowser)()&&window.removeEventListener("scroll",l)}),[l]),t},G=({onInstall:e,onClose:t,appPlatform:n})=>{const[o,l]=r.useState(!1),[s,c]=r.useState(!1),{bannerRef:i,bannerHeightInPixels:d}=F();r.useEffect(()=>{c(!0)},[]);const u=D(d);return o?null:r.createElement("div",{className:g()(v.cw),style:{minHeight:`${d}px`}},s?r.createElement("div",{ref:i,className:g()(u?y._Su:y.cky,y.d7k,b.$3,L.y,w.JSK,v.OL,S.FnB,S.sSJ,S.rAz),style:{rowGap:8,minHeight:"2.5rem",padding:"10px 12px"}},r.createElement("div",{className:g()(v.OL,S.FnB,S.iTO,S.sSJ,S.rAz),style:{flex:1,rowGap:8}},r.createElement(P,{onInstall:e}),r.createElement(T,{appPlatform:n})),r.createElement(C,{onClose:()=>{(0,a.requestIdleCallback)(()=>{t(),l(!0)})}})):null)};var U=n(89862);const j="smartbanner";function K(e){return e.split(" ").join("_").toLowerCase()}const V=({name:e,customCategory:t,customLabel:n,tools:a,customActionSuffix:r,rolloutFlags:o})=>{a.tracking.track({name:e,context:{customCategory:t,customLabel:n,customActionSuffix:r}},o)},J=(0,a.tile)().withTracking(e=>({resolve:()=>({context:{id:e.entity.id}})})).withRender(e=>{const{tools:t,context:n,ruleData:i}=e,d=t.cookies,m=n.deviceInfo,_=n.locale,E={enableStandaloneInShadow:Boolean(i.enableStandaloneInShadow),enableStandaloneOnly:Boolean(i.enableStandaloneOnly)};if(!m.appPlatform||function(e){return!!e&&!p.some(t=>t.toLowerCase()===e.toLowerCase())}(_)||function(e){const t=e.get(c),{view_count:n=0}=e.get(l)||{};return t||n>=6}(d))return null;r.useEffect(()=>{!function(e){let t=!1;(0,o.getConsent)(s).then(n=>{n.status&&!t&&(u(e),t=!0),(0,o.subscribe)(s,n=>{n.status&&!t&&(u(e),t=!0)})}).catch(()=>{})}(d)},[]);return r.createElement(a.ViewTracker,{onVisible:()=>{((e,t,n)=>{const a=`${j}-${t||""}`;V({name:U.wc,customCategory:j,customLabel:a,tools:e,rolloutFlags:n})})(t,m.appPlatform,E),t.tracking.trackStandalone(function({platform:e}){return{name:"view_content",context:{legacy_event_name:U.wc,event_trigger_name:K(`${j}-${e||""}`)}}}({platform:m.appPlatform}),E)}},r.createElement(G,{onInstall:async()=>{var e;const n=await f({appStoreUrl:m.appStoreUrl,locale:_});null==(e=window.open(n,"_blank"))||e.focus(),((e,t,n)=>{const a=`${j}-${t||""}`;V({name:U.bD,customCategory:j,customLabel:a,tools:e,rolloutFlags:n})})(t,m.appPlatform,E),t.tracking.trackStandalone(function({platform:e}){return{name:"select_content",context:{legacy_event_name:U.bD,event_trigger_name:K(`${j}-${e||""}`)}}}({platform:m.appPlatform}),E)},onClose:()=>{d.set(c,!0,21),((e,t,n)=>{const a=`${j}-${t||""}`;V({name:U.bD,customCategory:j,customLabel:a,tools:e,customActionSuffix:"close",rolloutFlags:n})})(t,m.appPlatform,E),t.tracking.trackStandalone(function({platform:e}){return{name:"select_content",context:{legacy_event_name:U.bD,event_trigger_name:K(`close.${j}-${e||""}`)}}}({platform:m.appPlatform}),E)},appPlatform:m.appPlatform}))})},80374:()=>{window.__RENDERING_ENGINE_TRANSLATION_KEYS__={...window.__RENDERING_ENGINE_TRANSLATION_KEYS__,"app-download-banner":["main.close","download.app.banner.cta","download.app.banner.alt.cta"]}},85959:e=>{"use strict";e.exports=n},94179:e=>{"use strict";e.exports=a}},e=>{var t=t=>e(e.s=t);return e.O(0,[29674],()=>(t(80374),t(63225))),e.O()}]));
//# sourceMappingURL=https://zalando.de/dev/source-maps/app-download-banner/index-63f73019a6999e377a29.js.map