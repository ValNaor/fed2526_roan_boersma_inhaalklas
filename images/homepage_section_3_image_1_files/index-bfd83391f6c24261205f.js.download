define(["z-shop-event-bus","classnames","rendering-engine-api","react-dom","react"],(e,t,i,n,o)=>(self.renderingEngineWebpackJsonp=self.renderingEngineWebpackJsonp||[]).push([[47868],{21775:t=>{"use strict";t.exports=e},30812:e=>{"use strict";e.exports=t},32740:e=>{"use strict";e.exports=i},35394:()=>{window.__RENDERING_ENGINE_TRANSLATION_KEYS__={...window.__RENDERING_ENGINE_TRANSLATION_KEYS__,"entity_plus-exclusivity-notifications":["loyalty_points.missions.success.pointscollected","max.order.limit.notification.pdp","max.customer.limit.notification.pdp","max.customer.limit.notification.wardrobe.web"]}},39466:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>$});var n=i(32740),o=i(85959),a=i(95478),c=i(52292),r=i(21775),s=i(28258);const E=({notifications:{defaultNotifications:e=[]},tracking:t,notificationPayload:i})=>{const[n,a]=o.useState(!1);return o.useEffect(()=>{a(!0)},[]),e.forEach(({component:e,eventTracker:o})=>{(({notificationPayload:e,component:t,eventTracker:i,tracking:n,isClientReady:o})=>{o&&(s.h.show(t(e)),n&&i&&i(n))})({notificationPayload:i,component:e,eventTracker:o,tracking:n?t:null,isClientReady:n})}),null},l=(0,o.createContext)({});var u=function(e){return e.PURCHASE_RESTRICTION="PURCHASE_RESTRICTION",e.PURCHASE_LIMIT_REACHED="PURCHASE_LIMIT_REACHED",e.PURCHASE_LIMIT_REACHED_WARDROBE="PURCHASE_LIMIT_REACHED_WARDROBE",e.LOYALTY_MISSION_COMPLETED="LOYALTY_MISSION_COMPLETED",e}(u||{}),R=function(e){return e.DEFAULT="DEFAULT",e}(R||{}),d=function(e){return e.PDP="PDP",e.WARDROBE="WARDROBE",e}(d||{}),_=i(91936),T=i(2673),m=i(52130);const A={purchaseRestrictionOnLoadText:()=>__("max.order.limit.notification.pdp"),purchaseRestrictionInPageText:()=>__("max.customer.limit.notification.pdp"),purchaseRestrictionWardrobeText:()=>__("max.customer.limit.notification.wardrobe.web")},C=(e=d.PDP)=>{const{purchaseRestrictionInPageText:t,purchaseRestrictionWardrobeText:i}=A;return()=>o.createElement(_.E,{timeout:5e3,clickToHide:!1,action:{shouldHideOnClick:!1}},o.createElement(T.Ay,{color:m.r7.inverse,preset:m.nx.body},e==d.PDP?t():i()))},P=C(d.PDP),S=C(d.WARDROBE),I=()=>o.createElement(_.E,{clickToHide:!1,action:{shouldHideOnClick:!1}},o.createElement(T.Ay,{color:m.r7.inverse,preset:m.nx.body},A.purchaseRestrictionOnLoadText()));var D=i(30812),p=i.n(D),L=i(4821),f=i(5073),y=i(38856),O=i(10170),h=i(15184),H=i(22837);const N=({amount:e})=>o.createElement(_.E,{timeout:5e3,clickToHide:!1,action:{shouldHideOnClick:!1}},o.createElement(h.Sv,{colorScheme:H.z.monochromeDark,className:p()(f.OL,y.FnB)},o.createElement(L.A,{logo:"LoyaltyPointsShort",size:"s"}),o.createElement(T.Ay,{preset:m.nx.bodySmall,className:O.uB3},`${e} ${__("loyalty_points.missions.success.pointscollected")}`)));var k=function(e){return e.PURCHASE_RESTRICTED="product availability restriction",e.PURCHASE_RESTRICTED_CART="cart",e.PURCHASE_RESTRICTED_LIMIT_REACHED="bought",e}(k||{}),M=function(e){return e.PDP="product detail page",e.WARDROBE="wardrobe",e}(M||{}),U=i(89862);const b={[u.PURCHASE_RESTRICTION]:{component:I,eventTracker:e=>{e.track({name:U.n6,context:{customCategory:M.PDP,customLabel:`${k.PURCHASE_RESTRICTED} ${k.PURCHASE_RESTRICTED_CART}`}})},kind:R.DEFAULT},[u.PURCHASE_LIMIT_REACHED]:{component:P,eventTracker:e=>{e.track({name:U.n6,context:{customCategory:M.PDP,customLabel:`${k.PURCHASE_RESTRICTED} ${k.PURCHASE_RESTRICTED_LIMIT_REACHED}`}})},kind:R.DEFAULT},[u.PURCHASE_LIMIT_REACHED_WARDROBE]:{component:S,eventTracker:e=>{e.track({name:U.wc,context:{customCategory:M.WARDROBE,customLabel:`liked items.add to cart.notification.${k.PURCHASE_RESTRICTED}`}})},kind:R.DEFAULT},[u.LOYALTY_MISSION_COMPLETED]:{component:({amount:e})=>N({amount:e}),kind:R.DEFAULT}},v=({earlyAccessReminderNotification:e,isInitialPageLoad:t,isMobile:i,isPurchaseQuantityRestricted:n,isPurchaseQuantityLimitReached:o,loyaltyMissionNotification:a})=>{const c=[];return n&&t&&c.push(u.PURCHASE_RESTRICTION),i&&o&&c.push(u.PURCHASE_LIMIT_REACHED),e&&c.push(e),a&&c.push(a),(e=>e.reduce(({defaultNotifications:e},t)=>{const i=b[t];return{defaultNotifications:i.kind===R.DEFAULT?[...e,i]:e}},{defaultNotifications:[]}))(c)},x=e=>0===e,g=(e,t)=>null!==e&&e>0&&t>=e,w=({isMobile:e,purchaseQuantityLimit:t,tracking:i},{earlyAccessReminderNotification:n,loyaltyMissionNotification:o,isInitialPageLoad:a,numPurchases:c})=>({notifications:v({earlyAccessReminderNotification:n,loyaltyMissionNotification:o,isInitialPageLoad:a,isMobile:e,isPurchaseQuantityRestricted:x(t),isPurchaseQuantityLimitReached:g(t,c)}),tracking:i}),W=()=>{const e=o.useContext(l),[t,i]=o.useState(!0),[n,a]=o.useState(0),[c,s]=o.useState(),[R,d]=o.useState(),[_,T]=o.useState(),m=e=>{d(u.LOYALTY_MISSION_COMPLETED),T(e)};return o.useEffect(()=>{i(!1),r.on("PDP$ADD_TO_CART_SUCCESS",()=>{a(e=>e+1)}),r.on("WARDROBE$PURCHASE_LIMIT_REACHED",()=>{s(u.PURCHASE_LIMIT_REACHED_WARDROBE)}),r.on("PLUS$LOYALTY_MISSION_COMPLETED_SUCCESS_EVENT",m)},[]),o.createElement(E,{...w(e,{earlyAccessReminderNotification:c,loyaltyMissionNotification:R,isInitialPageLoad:t,numPurchases:n}),notificationPayload:{amount:_}})},B=e=>({id:e.entity.id}),Y=(0,c.C)(e=>e.children),$=(0,n.tile)().withQueries(e=>{var t;return(null==e||null==(t=e.ruleData)?void 0:t.showProductInfo)?{data:{query:a,variables:B(e)}}:{}}).withTracking(e=>({resolve:()=>({context:B(e)})})).withProcessDependencies(({data:e={}})=>({action:"render",data:e})).withRender(e=>{var t,i;const{data:a,context:{deviceInfo:c},tools:{tracking:r}}=e;var s;const E={isMobile:c.isMobile,purchaseQuantityLimit:null!=(s=null==a||null==(i=a.product)||null==(t=i.purchaseRestriction)?void 0:t.quantityLimit)?s:null,tracking:r};return o.createElement(l.Provider,{value:E},o.createElement(Y,{disableListeners:!0,serverMedia:c,isTouchOnServer:!c.isDesktop},o.createElement(n.ViewTracker,null,o.createElement(W,null))))})},48398:e=>{"use strict";e.exports=n},85959:e=>{"use strict";e.exports=o},95478:e=>{e.exports={id:"190ea2fecc82a0655e07500478835684eab6ec2eb795a424b916bfd797ef484b"}}},e=>{var t=t=>e(e.s=t);return e.O(0,[29674],()=>(t(35394),t(39466))),e.O()}]));
//# sourceMappingURL=https://zalando.de/dev/source-maps/entity_plus-exclusivity-notifications/index-bfd83391f6c24261205f.js.map